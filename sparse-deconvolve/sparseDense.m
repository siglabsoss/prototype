%sparse = [37989372, 38004115, 38069971, 38083987, 38091283, 38105299, 38111443, 38126419, 38133523, 38147923, 38154643, 38168851, 38175955, 38189971, 38197075, 38211283, 38217235, 38231443, 38238931, 38240275, 38326483, 38409619, 38495059, 38578579, 38663251, 38747347, 38831827, 38916307, 39000595, 39085459, 39106579, 39128083, 39149395, 39169747, 39190867, 39211795, 39233107, 39254419, 39275731, 39297043, 39318163, 39339091, 39360211, 39381331, 39402835, 39423763, 39445075, 39466195, 39486355, 39507667, 39528787, 39550867, 39572179, 39593299, 39613651, 39634771, 39655315, 39761299, 39845395, 39930067, 40014739, 40099603, 40120723, 40142035, 40163155, 40267987, 40352659, 40437139, 40522579, 40605907, 40691539, 40775251, 40859347, 40944019, 41028307, 41112787, 41197075, 41281747, 41366419, 41451091, 41472211, 41493715, 41514835, 41535379, 41556307, 41578195, 41599507, 41620819, 41641171, 41662483, 41684179, 41704147, 41725459, 41746963, 41768275, 41806867, 41808979, 41810323, 41840467, 41842195, 41903443, 41905555, 41928019, 41929747, 42049363, 42051475, 42058579, 42060883, 42088147, 42089875, 42100051, 42102163, 42111187, 42112915, 42124627, 42126931, 42138643, 42140947, 42150547, 42152851, 42164563, 42166867, 42172243, 42174163, 42179923, 42182035, 42186451, 42188179, 42190675, 42192787, 42199891, 42202195, 42210643, 42212755, 42218707, 42220435, 42228115, 42229651, 42238675, 42240211, 42243283, 42244819, 42251923, 42254227, 42258643, 42260371, 42268051, 42269587, 42270547, 42272275, 42275155, 42277651, 42282643, 42284755, 42291859, 42294163, 42295123, 42297235, 42300115, 42301843, 42313939, 42315475, 42321235, 42323347, 42330643, 42332563, 42339667, 42341779, 42347347, 42349459, 42360019, 42361747, 42369427, 42370963, 42373459, 42375571, 42390547, 42392851, 42395347, 42397075, 42399955, 42401299, 42405715, 42407827, 42408787, 42410899, 42415315, 42416851, 42418003, 42420115, 42427219, 42429331, 42433171, 42435475, 42441043, 42443155, 42447187, 42449491, 42461395, 42464659, 42477907, 42480019, 42499219, 42501331, 42507091, 42509203, 42522451, 42524755, 42532051, 42535315, 42548947, 42550675, 42551635, 42553171, 42557779, 42560083, 42565843, 42567379, 42574483, 42576787, 42580819, 42584467, 42588499, 42590803, 42600787, 42602707, 42608467, 42610579, 42611923, 42613651, 42621331, 42622867, 42628627, 42632083, 42636499, 42638035, 42642451, 42644371, 42656659, 42658195, 42665299, 42667027, 42668563, 42670867, 42674515, 42676627, 42682579, 42684307, 42693139, 42695059, 42711187, 42713299, 42720403, 42722707, 42734419, 42736723, 42742099, 42744019, 42757843, 42759571, 42760531, 42762643, 42769747, 42772051, 42775891, 42778003, 42782035, 42783955, 42789715, 42791827, 42796243, 42797971, 42809683, 42812947, 42823891, 42825619, 42830995, 42833299, 42835987, 42837907, 42845011, 42847315, 42854419, 42857875, 42863827, 42865555, 42875731, 42878035, 42880531, 42883987, 42891283, 42893203, 42899155, 42900883, 42915667, 42917971, 42918739, 42920659, 42932371, 42936211, 42939283, 42940819, 42941779, 42943891, 42950995, 42953299, 42960403, 42962707, 42977491, 42979219, 42983251, 42985363, 43000339, 43003795, 43013971, 43016083, 43020115, 43023379, 43026259, 43028755, 43035667, 43037587, 43042003, 43043731, 43045075, 43046803, 43052371, 43054483, 43056979, 43059283, 43067731, 43069843, 43072339, 43074451, 43078291, 43080595, 43083475, 43085203, 43090771, 43092883, 43099987, 43101907, 43109011, 43111315, 43121491, 43123027, 43127635, 43129939, 43135315, 43137235, 43144339, 43148179, 43160467, 43162003, 43166419, 43167955, 43173907, 43175827, 43182931, 43184467, 43187539, 43189651, 43205203, 43206547, 43210963, 43212499, 43221715, 43223251, 43230547, 43232659, 43235155, 43237267, 43243027, 43245331, 43253587, 43255507, 43259539, 43261843, 43273555, 43277203, 43281235, 43283155, 43302931, 43304851, 43318291, 43320595, 43320979, 43323283, 43327699, 43329427, 43342675, 43346515, 43351891, 43355923, 43360915, 43363219, 43367827, 43369363, 43372435, 43373587, 43374931, 43377235, 43388947, 43391251, 43391635, 43393747, 43410451, 43412563, 43421011, 43423123, 43427539, 43430803, 43440979, 43443091, 43447123, 43449235, 43459795, 43461907, 43470163, 43471699, 43476307, 43478419, 43481107, 43483027, 43487059, 43489171, 43496275, 43498387, 43504339, 43506067, 43511635, 43514899, 43519315, 43521427, 43532947, 43535059, 43542163, 43546003, 43559251, 43561171, 43568467, 43570387, 43576147, 43578259, 43588435, 43590547, 43596307, 43598419, 43603795, 43607059, 43611475, 43613587, 43619731, 43621267, 43631443, 43633747, 43637971, 43640851, 43643539, 43645843, 43654483, 43657555, 43659667, 43661203, 43662163, 43663891, 43680979, 43682323, 43685587, 43687315, 43691347, 43693459, 43702099, 43704403, 43708243, 43710163, 43714195, 43716499, 43720915, 43722643, 43728211, 43730323, 43734355, 43736467, 43743571, 43745683, 43746835, 43749139, 43771411, 43773331, 43783507, 43785619, 43794067, 43796371, 43806931, 43808659, 43812883, 43815187, 43815763, 43817683, 43826899, 43828627, 43838803, 43840915, 43852819, 43855123, 43860115, 43862419, 43867987, 43870099, 43874131, 43876243];
sparse = [0,15, 16, 17, 19, 30];


comb = [1,-1,1,1,-1,-1,-1,-1,-1];

[rows,A]=size(sparse);
B = sparse(A)-sparse(1);
dense = zeros(1,B);
sig = 1;
j = 1;

disp('here we go');

% interpolate
for i = sparse(1):sparse(A)

	if i == sparse(j)
   		sig = sig * -1;
   		j = j + 1;
	end

	dense(i-sparse(1)+1) = sig;
end

disp('done');


denseSize = size(dense,2);

% shorter vector is 0 padded to make it the same size as larger
% result is 2N - 1 samples
c = xcorr(dense, comb);

[junk, result] = max(c);

% we assume dense is larger than comb
% the result is the largest peak, minus half (due to properties of xcor), plus the first value of the sparse vector (because we subtracted this when we built the dense vector)
result = result - denseSize + sparse(1);

disp(sprintf('Result %d', result));



%c = c(1:end/2);  %cut c in half
[cr,cc] = size(c);
%c2 = circshift(c,[1,round(cc/2)])

t = 1+sparse(1):cc+sparse(1);

close all
figure;
%plot(t, c);

plot(c); 